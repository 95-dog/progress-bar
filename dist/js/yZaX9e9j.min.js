(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const i of t.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function m(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function a(e){if(e.ep)return;e.ep=!0;const t=m(e);fetch(e.href,t)}})();const p="dog-progress",f="move-bar",B="move-btn";class y{constructor(n,m){if(this.options={height:"10px",width:"100%",horizontal:!0,moveBtnPercentage:0,moveBtnRadius:"15px",step:1,handleProgressChange:e=>{}},this.isDragging=!1,this.moveBtnSelect=!1,this.init=()=>{this.element.classList.add(p),this.horizontal||this.element.classList.add("progress-vertical");let e=this.element;e.style.height=this.element.getAttribute("data-dogProgress-height")??this.options.height,e.style.width=this.element.getAttribute("data-dogProgress-width")??this.options.width,e.style.borderRadius=this.element.clientHeight/2+"px",e.addEventListener("click",t=>{this.updateMoveBarWidthAndMoveBtnLeft(this.horizontal?t.clientX:t.clientY)}),this.buildMoveBar(),this.element.addEventListener("positionChange",this.options.handleProgressChange),this.element.addEventListener("mouseover",t=>{this.addKeyboardListeners(),this.showMoveBtn()}),this.element.addEventListener("mouseout",t=>{this.removeKeyboardListeners(),this.hideMovBtn()})},this.addKeyboardListeners=()=>{this.removeKeyboardListeners(),document.addEventListener("keydown",this.handleKeyboardNavigation)},this.removeKeyboardListeners=()=>{document.removeEventListener("keydown",this.handleKeyboardNavigation)},this.handleKeyboardNavigation=e=>{let t=this.element.getBoundingClientRect(),i=this.moveBar.getBoundingClientRect(),s,o;this.horizontal?(s=this.options.step/100*t.width,e.key==="ArrowLeft"&&(o=Math.max(0,i.width-s)+t.left),e.key==="ArrowRight"&&(o=Math.min(t.width,i.width+s)+t.left),this.updateMoveBarWidthAndMoveBtnLeft(o)):(s=this.options.step/100*t.height,e.key==="ArrowUp"?o=t.top+(t.height-(i.height+s)):e.key==="ArrowDown"&&(o=t.top+(t.height-(i.height-s))),this.updateMoveBarWidthAndMoveBtnLeft(o))},this.showMoveBtn=()=>{this.moveBtn.style.visibility="unset",this.moveBtn.style.opacity="1"},this.hideMovBtn=()=>{this.moveBtnSelect||(this.moveBtn.style.visibility="hidden",this.moveBtn.style.opacity="0")},this.bindPositionChange=()=>{let e=this.horizontal?"width":"height",t=new CustomEvent("positionChange",{detail:{percentage:parseFloat((this.moveBar.getBoundingClientRect()[e]/this.element.getBoundingClientRect()[e]).toFixed(2))}});this.element.dispatchEvent(t)},this.buildMoveBar=()=>{let e=document.createElement("div"),t=this.horizontal?"width":"height",i=+this.element.getAttribute("data-dogProgress-value")||this.options.moveBtnPercentage;if(e.classList.add(f),i){if(i<0||i>1)throw new Error("moveBtnPercentage的值为0-1之间");e.style[t]=`${i*100}%`}e.style.borderRadius=this.element.clientHeight/2+"px",this.element.append(e),this.moveBar=e,this.buildMoveBtn()},this.buildMoveBtn=()=>{let e=document.createElement("div"),t=this.horizontal?"right":"top";e.classList.add(B),e.style.height=this.options.moveBtnRadius,e.style.width=this.options.moveBtnRadius,this.moveBar.append(e),e.style[t]=`-${e.offsetWidth/2}px`,this.moveBtn=e,this.moveBtn.addEventListener("mousedown",()=>{this.isDragging=!0,this.moveBtnSelect=!0,document.addEventListener("mousemove",this.onMousemove),document.addEventListener("mouseup",this.onMouseup)})},this.onMouseup=e=>{document.removeEventListener("mousemove",this.onMousemove),document.removeEventListener("mouseup",this.onMouseup),this.isDragging=!1,this.moveBtnSelect=!1,this.hideMovBtn(),this.setUserSelect("")},this.onMousemove=e=>{!this.isDragging||!this.element||!this.moveBar||!this.moveBtn||(this.setUserSelect("none"),this.updateMoveBarWidthAndMoveBtnLeft(this.horizontal?e.clientX:e.clientY))},this.updateMoveBarWidthAndMoveBtnLeft=e=>{let t,i,s,o;this.horizontal?(t="left",i="width",s="width",o="right"):(t="top",i="height",s="height",o="top"),requestAnimationFrame(()=>{let h=this.element.getBoundingClientRect(),c=e-h[t],v=this.moveBtn.offsetWidth/2,l,r,g,d=h[i]*(this.options.step/100);this.horizontal?(r=Math.round(Math.max(0,Math.min(c,h[i]))/d)*d,g=r/h.width*100,l=-v,r<this.moveBtn.getBoundingClientRect().width&&(l=-(this.moveBtn.getBoundingClientRect().width-+r.toFixed(0)))):(r=Math.round(Math.max(0,Math.min(h[i]-c,h[i]))/d)*d,g=r/h.height*100,l=0,c>=h.height-this.moveBtn.getBoundingClientRect().height&&(l=Math.max(-this.moveBtn.offsetWidth,r-this.moveBtn.offsetWidth))),this.moveBar.style[s]=g+"%",this.moveBtn.style[o]=l+"px",this.bindPositionChange()})},this.setUserSelect=e=>{document.body.style.userSelect=e},!n){console.error(`Element is "${n}"`);return}if(this.element=n,this.options=Object.assign({},this.options,m),this.options.step=+this.options.step.toFixed(0),this.options.step<0||this.options.step>100)throw Error("step 的值只能为0-100之间的整数");this.horizontal=this.options.horizontal;let a=n.getAttribute("data-dogProgress-horizontal");a&&(a==="true"&&(this.horizontal=!0),a==="false"&&(this.horizontal=!1)),this.init()}}let M=document.querySelectorAll(".volume-progress");M.forEach(u=>new y(u,{}));
